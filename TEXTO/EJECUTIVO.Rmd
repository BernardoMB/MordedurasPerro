---
title: "Reporte EJECUTIVO"
author: "Fernando Chávez 142353, Bernardo Mondragón 143743, Rayan García 144424"
date: "17 de octubre de 2016"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r , echo=FALSE, message=FALSE, warning=FALSE, results='hide'}
library(data.table)
library(dplyr)
library(tidyr)
library(ggplot2)
library(gridExtra)
library(ggmap)
library(gridExtra)
#library(cowplot)

# ---------------------------- 1.- Directorio de Trabajo --------------------------

# Especificar el directorio de trabajo.
# El directorio de trabajo debe ser la capeta del proyecto:
workingDirectory <- "/Users/ferchavez100/Desktop/MordedurasPerro/DATOS/BRUTOS"     #<----- CAMBIAR DIRECTORIO DE TRABAJO
setwd(workingDirectory)


# ---------------------------- 2.- Lectura de Tablas ------------------------------

getNames <- function() {
  nombres <- NULL
  nombres <- c()
  for (i in 1:12) {
    nombres <- c(nombres, paste(2003 + i))
  }
  return(nombres)
}
nombres <- getNames()

# --------------- 2.1.- Fuente de Notificacion.

# Fuente de Notificacion General
spath <-paste(getwd(), "/CSV/FuenteDeNotificacion/General/", sep="")
setwd(spath)
fng <- list.files()
fng
fng <- lapply(fng, fread, sep=",")
names(fng) <- nombres
setwd(workingDirectory)

# Fuente de Notificacion Hombres
spath <-paste(getwd(), "/CSV/FuenteDeNotificacion/Hombres/", sep="")
setwd(spath)
fnh <- list.files()
fnh <- lapply(fnh, fread, sep=",")
names(fnh) <- nombres
setwd(workingDirectory)

# Fuente de Notificacion Mujeres
spath <-paste(getwd(), "/CSV/FuenteDeNotificacion/Mujeres/", sep="")
setwd(spath)
fnm <- list.files()
fnm <- lapply(fnm, fread, sep=",")
names(fnm) <- nombres
setwd(workingDirectory)

# --------------- 2.2.- Grupo de Edad.

# Grupo de Edad General
spath <-paste(getwd(), "/CSV/GrupoDeEdad/General/", sep="")
setwd(spath)
geg <- list.files()
geg <- lapply(geg, fread, sep=",")
names(geg) <- nombres
setwd(workingDirectory)

# Grupo de Edad Hombres
spath <-paste(getwd(), "/CSV/GrupoDeEdad/Hombres/", sep="")
setwd(spath)
geh <- list.files()
geh <- lapply(geh, fread, sep=",")
names(geh) <- nombres
setwd(workingDirectory)

# Grupo de Edad Mujeres
spath <-paste(getwd(), "/CSV/GrupoDeEdad/Mujeres/", sep="")
setwd(spath)
gem <- list.files()
gem <- lapply(gem, fread, sep=",")
names(gem) <- nombres
setwd(workingDirectory)

# --------------- 2.3.- Mes de Ocurrencia.

# Mes de Ocurrencia General
spath <-paste(getwd(), "/CSV/MesDeOcurrencia/General/", sep="")
setwd(spath)
mog <- list.files()
mog <- lapply(mog, fread, sep=",")
names(mog) <- nombres
setwd(workingDirectory)

# Mes de Ocurrencia Hombres
spath <-paste(getwd(), "/CSV/MesDeOcurrencia/Hombres/", sep="")
setwd(spath)
moh <- list.files()
moh <- lapply(moh, fread, sep=",")
names(moh) <- nombres
setwd(workingDirectory)

# Mes de Ocurrencia Mujeres
spath <-paste(getwd(), "/CSV/MesDeOcurrencia/Mujeres/", sep="")
setwd(spath)
mom <- list.files()
mom <- lapply(mom, fread, sep=",")
names(mom) <- nombres
setwd(workingDirectory)

# --------------- 2.4.- Diccionario.

FuenteDeNotificacion = list(fng, fnh, fnm)
names(FuenteDeNotificacion) <- c("General", "Hombres", "Mujeres")

GrupoDeEdad = list(geg, geh, gem)
names(GrupoDeEdad) <- c("General", "Hombres", "Mujeres")

MesDeOcurrencia = list(mog, moh, mom)
names(MesDeOcurrencia) <- c("General", "Hombres", "Mujeres")

mpData = list(FuenteDeNotificacion, GrupoDeEdad, MesDeOcurrencia)
names(mpData) <- c("FuenteDeNotificacion", "GrupoDeEdad", "MesDeOcurrencia")

# ------------ 3.- Limpieza de Codigo.

# ---------------- 3.1.- Eliminacion de columnas.

# Elimina la columna TOTAL de los data.frames de Fuente de Notificacion.
for (i in 1:length(mpData$FuenteDeNotificacion)) {
  for (j in 1:length(mpData$FuenteDeNotificacion[[i]])) {
    mpData$FuenteDeNotificacion[[i]][[j]][[11]] <- NULL
  }
}

# Elimina la columna TOTAL de los data.frames de Gruepo de Edad.
for (i in 1:length(mpData$GrupoDeEdad)) {
  for (j in 1:length(mpData$GrupoDeEdad[[i]])) {
    mpData$GrupoDeEdad[[i]][[j]][[14]] <- NULL
  }
} 

# ---------------- 3.2.- Nombres, Agrega columnas, Pasa a formato organizado, Mordeduras to numeric.

# Corrige el nombre de los estados y de los encabezados.
for (i in 1:length(mpData)) {
  cat <- mpData[[i]]
  for (j in 1:length(cat)) {
    type <- cat[[j]]
    for (l in 1:length(type)) {
      names(type[[l]]) <- toupper(names(type[[l]]))
    }
    for (m in 1:length(type)) {
      if (i == 1) {
        # Fuente de Notificacion
        type[[m]] <- within(type[[m]], 
                            {
                              SALUD <- gsub("[ ]", "", SALUD)
                              IMSS.ORD <- gsub("[ ]", "", IMSS.ORD)
                              ISSSTE <- gsub("[ ]", "", ISSSTE)
                              IMSS.OP <- gsub("[ ]", "",IMSS.OP)
                              DIF <- gsub("[ ]", "", DIF)
                              PEMEX <- gsub("[ ]", "", PEMEX)
                              SEDENA <- gsub("[ ]", "", SEDENA)
                              SEMAR <- gsub("[ ]", "", SEMAR)
                              OTRAS <- gsub("[ ]", "", OTRAS)
                              IMSS.ORD <- gsub("N.A.*|S.R*|NA.", "NA", IMSS.ORD)
                              SALUD <- gsub("N.A.*|S.R*|NA.", "NA", SALUD)
                              ISSSTE <- gsub("N.A.*|S.R*|NA.", "NA", ISSSTE)
                              IMSS.OP <- gsub("N.A.*|S.R*|NA.", "NA",IMSS.OP)
                              DIF <- gsub("N.A.*|S.R*|NA.", "NA", DIF)
                              PEMEX <- gsub("N.A.*|S.R*|NA.", "NA", PEMEX)
                              SEDENA <- gsub("N.A.*|S.R*|NA.", "NA", SEDENA)
                              SEMAR <- gsub("N.A.*|S.R*|NA.", "NA", SEMAR)
                              OTRAS <- gsub("N.A.*|S.R*|NA.", "NA", OTRAS)
                              ESTADO <- gsub("M.*co.*", "Mexico", ESTADO)
                              ESTADO <- gsub("Agua.*es.*", "Aguascalientes", ESTADO)
                              ESTADO <- gsub("Dist.*al.*", "Distrito Federal", ESTADO)
                              ESTADO <- gsub("Guan.*o.*", "Guanajuato", ESTADO)
                              ESTADO <- gsub("H.idalgo*", "Hidalgo", ESTADO) 
                              ESTADO <- gsub("M.*n.*", "Michoacan", ESTADO)
                              ESTADO <- gsub("M.*los.*", "Morelos", ESTADO)
                              ESTADO <- gsub("Nuevo L.*e.*.*.*.*n.*", "Nuevo Leon", ESTADO)
                              ESTADO <- gsub("Nuevo Le.*n.*", "Nuevo Leon", ESTADO)
                              ESTADO <- gsub("T.abasco*", "Tabasco", ESTADO)
                              ESTADO <- gsub("T.amaulipas*", "Tamaulipas", ESTADO)
                              ESTADO <- gsub("Quer.*ro.*", "Queretaro", ESTADO)
                              ESTADO <- gsub("Z.acatecas.*", "Zacatecas", ESTADO)
                              ESTADO <- gsub("Zac.*cas.*", "Zacatecas", ESTADO)
                              ESTADO <- gsub("Quint.*oo.*", "Quintana Roo", ESTADO)
                              ESTADO <- gsub("San Luis Pot.*.*", "San Luis Potosi", ESTADO)
                              ESTADO <- gsub("Yuca.*n.*", "Yucatan",ESTADO)
                            })
        # Agregando la columna sexo para pasar a formato organizado.
        if (j == 1) {
          SEXO <- c()
          for (n in 1:32) {
            SEXO <- c(SEXO, "GENERAL")
          }
          type[[m]][["SEXO"]] <- SEXO
        } else if (j == 2) {
          SEXO <- c()
          for (n in 1:32) {
            SEXO <- c(SEXO, "HOMBRES")
          }
          type[[m]][["SEXO"]] <- SEXO
        } else if (j == 3) {
          SEXO <- c()
          for (n in 1:32) {
            SEXO <- c(SEXO, "MUJERES")
          }
          type[[m]][["SEXO"]] <- SEXO
        }
        # Agregando la columna de a??o para pasar a formato organizado.
        ANIO <- c()
        for (p in 1:32) {
          ANIO <- c(ANIO, 2003 + m)
        }
        type[[m]][["ANIO"]] <- ANIO
        # Pasar a formato organizado.
        type[[m]] <- gather(data = type[[m]], 
                         key = "FUENTE", 
                         value = "MORDEDURAS", 
                         2:10)
      } 
      else if (i == 2) {
        # Grupo de Edad
        type[[m]] <- within(type[[m]] , 
                            {
                              MAYOR.A.UNO <- gsub("[ ]", "", MAYOR.A.UNO)
                              UNO.A.CUATRO <- gsub("[ ]", "", UNO.A.CUATRO)
                              CINCO.A.NUEVE <- gsub("[ ]", "", CINCO.A.NUEVE)
                              DIEZ.A.CATORCE <- gsub("[ ]", "",DIEZ.A.CATORCE)
                              QUINCE.A.DIECINUEVE <- gsub("[ ]", "", QUINCE.A.DIECINUEVE)
                              VEINTE.A.VEINTICUATRO <- gsub("[ ]", "", VEINTE.A.VEINTICUATRO )
                              VEINTICINCO.A.CUARENTAYCUATRO <- gsub("[ ]", "", VEINTICINCO.A.CUARENTAYCUATRO)
                              CUARENTAYCINCO.A.CUARENTAYNUEVE <- gsub("[ ]", "", CUARENTAYCINCO.A.CUARENTAYNUEVE)
                              CINCUENTA.A.CINCUENTAYNUEVE <- gsub("[ ]", "", CINCUENTA.A.CINCUENTAYNUEVE)
                              SESENTA.A.SESENTAYCUATRO <- gsub("[ ]", "", SESENTA.A.SESENTAYCUATRO)
                              MAYOR.A.SESENTAYCINCO <- gsub("[ ]", "", MAYOR.A.SESENTAYCINCO)
                              NO.SE.REPORTO.LA.EDAD <- gsub("[ ]", "", NO.SE.REPORTO.LA.EDAD)
                              ESTADO <- gsub("M.*co.*", "Mexico", ESTADO)
                              ESTADO <- gsub("Agua.*es.*", "Aguascalientes", ESTADO)
                              ESTADO <- gsub("Dist.*al.*", "Distrito Federal", ESTADO)
                              ESTADO <- gsub("Guan.*o.*", "Guanajuato", ESTADO)
                              ESTADO <- gsub("M.*n.*", "Michoacan", ESTADO)
                              ESTADO <- gsub("M.*los.*", "Morelos", ESTADO)
                              ESTADO <- gsub("Nuevo Le.*n.*", "Nuevo Leon", ESTADO)
                              ESTADO <- gsub("Quer.*ro.*", "Queretaro", ESTADO)
                              ESTADO <- gsub("Zac.*cas.*", "Zacatecas", ESTADO)
                              ESTADO <- gsub("Quint.*oo.*", "Quintana Roo", ESTADO)
                              ESTADO <- gsub("San Luis Pot.*.*", "San Luis Potosi", ESTADO)
                              ESTADO <- gsub("Yuca.*n.*", "Yucatan",ESTADO)
                            })
        # Agregando la columna sexo para pasar a formato organizado.
        if (j == 1) {
          SEXO <- c()
          for (n in 1:32) {
            SEXO <- c(SEXO, "GENERAL")
          }
          type[[m]][["SEXO"]] <- SEXO
        } else if (j == 2) {
          SEXO <- c()
          for (n in 1:32) {
            SEXO <- c(SEXO, "HOMBRES")
          }
          type[[m]][["SEXO"]] <- SEXO
        } else if (j == 3) {
          SEXO <- c()
          for (n in 1:32) {
            SEXO <- c(SEXO, "MUJERES")
          }
          type[[m]][["SEXO"]] <- SEXO
        }
        # Agregando la columna de a??o para pasar a formato organizado.
        ANIO <- c()
        for (p in 1:32) {
          ANIO <- c(ANIO, 2003 + m)
        }
        type[[m]][["ANIO"]] <- ANIO
        # Pasar a formato organizado.
        type[[m]] <- gather(data = type[[m]], 
                         key = "EDAD", 
                         value = "MORDEDURAS", 
                         2:13)
      } 
      else if (i == 3) {
        # Mes de ocurrencia
        type[[m]] <- within(type[[m]] , 
                             {
                               ESTADO <- gsub("M.*co.*", "Mexico", ESTADO)
                               ESTADO <- gsub("Agua.*es.*", "Aguascalientes", ESTADO)
                               ESTADO <- gsub("Dist.*al.*", "Distrito Federal", ESTADO)
                               ESTADO <- gsub("Guan.*o.*", "Guanajuato", ESTADO)
                               ESTADO <- gsub("M.*n.*", "Michoacan", ESTADO)
                               ESTADO <- gsub("M.*los.*", "Morelos", ESTADO)
                               ESTADO <- gsub("Nuevo Le.*n.*", "Nuevo Leon", ESTADO)
                               ESTADO <- gsub("Quer.*ro.*", "Queretaro", ESTADO)
                               ESTADO <- gsub("Zac.*cas.*", "Zacatecas", ESTADO)
                               ESTADO <- gsub("Quint.*oo.*", "Quintana Roo", ESTADO)
                               ESTADO <- gsub("San Luis Pot.*.*", "San Luis Potosi", ESTADO)
                               ESTADO <- gsub("Yuca.*n.*", "Yucatan",ESTADO)
                             })
        # Agregando la columna sexo para pasar a formato organizado.
        if (j == 1) {
          SEXO <- c()
          for (n in 1:32) {
            SEXO <- c(SEXO, "GENERAL")
          }
          type[[m]][["SEXO"]] <- SEXO
        } else if (j == 2) {
          SEXO <- c()
          for (n in 1:32) {
            SEXO <- c(SEXO, "HOMBRES")
          }
          type[[m]][["SEXO"]] <- SEXO
        } else if (j == 3) {
          SEXO <- c()
          for (n in 1:32) {
            SEXO <- c(SEXO, "MUJERES")
          }
          type[[m]][["SEXO"]] <- SEXO
        }
        # Agregando la columna de a??o para pasar a formato organizado.
        ANIO <- c()
        for (p in 1:32) {
          ANIO <- c(ANIO, 2003 + m)
        }
        type[[m]][["ANIO"]] <- ANIO
        # Pasar a formato organizado.
        type[[m]] <- gather(data = type[[m]], 
                         key = "MES", 
                         value = "MORDEDURAS", 
                         2:13)
      }
      type[[m]][["MORDEDURAS"]] <- as.numeric(type[[m]][["MORDEDURAS"]])
    }
    cat[[j]] <- type
  }
  mpData[[i]] <- cat 
}

# ---------------- 3.3.- Juntar todas las tablas en formato organizado ---------

ofnGeneral <- data.frame()
ofnHombres <- data.frame()
ofnMujeres <- data.frame()

ogeGeneral <- data.frame()
ogeHombres <- data.frame()
ogeMujeres <- data.frame()

omoGeneral <- data.frame()
omoHombres <- data.frame()
omoMujeres <- data.frame()

OFuenteDeNotifiacion = list(ofnGeneral, ofnHombres, ofnMujeres)
names(OFuenteDeNotifiacion) <- c("General","Hombres","Mujeres")

OGrupoDeEdad = list(ogeGeneral, ogeHombres, ogeMujeres)
names(OGrupoDeEdad) <- c("General","Hombres","Mujeres")

OMesDeOcurrencia = list(omoGeneral, omoHombres, omoMujeres)
names(OMesDeOcurrencia) <- c("General","Hombres","Mujeres")

mpOData = list(OFuenteDeNotifiacion, OGrupoDeEdad, OMesDeOcurrencia)
names(mpOData) <- c("FuenteDeNotificacion","GrupoDeEdad","MesDeOcurrencia")

for (i in 1:3) {
  for (j in 1:3) {
     mpOData[[i]][[j]] <- do.call(rbind, mpData[[i]][[j]])
  }
}

orgFn = data.frame()
orgGe = data.frame()
orgMo = data.frame()

mpOrgData = list(orgFn, orgGe, orgMo)
names(mpOrgData) <- c("FuenteDeNotificacion", "GrupoDeEdad", "MesDeOcurrencia")

for (i in 1:length(mpOrgData)) {
  mpOrgData[[i]] <- do.call(rbind, mpOData[[i]])
}

# --------------- Fin limpieza ------------------------
```


## 1. Introducción
El Proyecto consiste en el análisis de la incidencia en mordeduras de perro en México del año 2004 a 2015. Dicha incidencia se ordena por Fuente de Notificación, Mes de Ocurrencia y Grupo de Edad. Los datos usados en este proyecto provienen de la secretaría de salud: http://www.epidemiologia.salud.gob.mx/anuario/html/anuarios.html. 

El objetivo es presentar una serie de gráficas y análisis de cómo ha cambiado la incidencia de las mordeduras de perro a través de los años. Los datos obtenidos de las distintas clasificaciones (i.e fuente de notificación, mes de ocurrencia y grupo de edad) se presentan de manera clara y organizada. 

Creemos que el análisis de datos es importante para el sector salud, ya que podría utilizarse para conocer la tendencia, la frecuencia y la variabilidad de los datos. Ya que si el sector salud conoce de manera detallada la incidencia de las mordeduras de perro en México puede tomar mejores decisiones para atender a la población, se pueden crear campañas o se pueden tomar con mayor seriedad los estados "problemáticos". 


## 2. Definición del Problema
En la obtención de los datos surgen varias preguntas a resolver y aclarar: ¿Cuál es la tendencia de las mordeduras de perro a través de los años?, ¿Cómo se cambió la incidencia de las mordeduras de perro en los estados cada año?, ¿Cómo se fueron reportando las mordeduras de perro en las fuentes de notificación a través de los años?, ¿Cómo se reportaron las mordeduras en los grupos de edad a través de los años?, ¿Cuáles son los estados que están por arriba de la media en cada año?, ¿Cuáles son los máximos y mínimos a través de los años?, ¿Cómo es la tendencia de cada estado en cada año?

Para poder resolver nuestras preguntas tuvimos que plantear nuestro análisis en cuatro divisiones:
La primera sería conocer el máximo, el mínimo, la media, la varianza, la desviación estándar, y los cuartiles, esto es para conocer mejor la probabilidad y la organización de nuestros datos en el tiempo.

La segunda pregunta surge de un pensamiento racional y clásico: ¿Cómo se están comportando las mordeduras en México a través de los años? es decir la tendencia.

La tercera, sería analizar cada una de nuestras variables(Fuente de Notificación, Mes de Ocurrencia y Grupo de Edad) incluyendo también por cada uno de nuestros estados el cambio en el tiempo en una multigráfica para ver con mayor precisión como los años cambian las mordeduras en el tiempo.

La cuarta, sería analizar nuestro proyecto con Boxplots, esto es para poder comparar junto con el primer análisis más detallado y ver cómo se comporta en términos de probabilidad nuestros datos y poder hacer una comparación objetiva.

## 3. Obtención y Descripción de los Datos
Se descargó cada PDF de la información de las mordeduras de perro y se convirtieron a formato Excel para más adelante poderlos pasar a formato CSV para poder hacer nuestros análisis en Rstudio.
Es importante mencionar que se limpiaron los datos, se organizaron y se modificaron para que de tal manera quedaran presentables.


## 4. Calidad de los Datos
En cuanto a la calidad de los datos, se hicieron pruebas de consistencia. Es decir, se verificó que el total de los archivos de GENERAL fueran iguales los totales de HOMBRES más MUJERES. Se comprobó que no hubiera ninguna inconsistencia en la igualdad de ningún año. También se comprobó que los totales fueran correctos en cada Formato, Fuente de Notificación, Mes de Ocurrencia y Grupo de Edad. 

## 5. Transformación de los Datos
Consideramos prescindible para entender el proyecto explicar cómo se encuentran los datos: 
Están organizados en tres tablas cada una por su respectiva fuente: Fuente de Notificación, Mes de Ocurrencia y Grupo de Edad.
En cada tabla se encuentran columnas indicando: Estado, Año, Sexo(General, Hombres o Mujeres), Fuente(Fuente de Notificación, Mes de Ocurrencia o Grupo de Edad) y Total de Mordeduras. 

Ejemplo:

### 5.1 Para Fuente de Noficación:
```{r , echo=FALSE}
head(mpOrgData$FuenteDeNotificacion)
```

### 5.2 Para Mes de Ocurrencia:
```{r , echo=FALSE}
head(mpOrgData$MesDeOcurrencia)
```

### 5.3 Para Grupo de Edad:
```{r , echo=FALSE}
head(mpOrgData$GrupoDeEdad)
```

## 6. Análisis Exploratorio

### 6.1 Tablas con información básica
Para cada tabla se incluye el Año, La fuente con el valor máximo y su respectivo valor, la fuente con el valor mínimo y su respectivo valor, la media, la desviación estándar, y cada cuartil. 


```{r , echo=FALSE}
# Medidas descriptivas.

describe <- function(categoria) {
  cat <- NULL
  raw <- NULL
  categorias <- c()
  if (categoria == "estado") {
    categorias <- c('Aguascalientes', 'Baja California', 'Baja California Sur', 'Campeche', 'Chiapas', 'Chihuahua', 'Coahuila', 'Colima', 'Distrito Federal', 'Durango', 'Guanajuato','Guerrero', 'Hidalgo', 'Jalisco', 'Mexico', 'Michoacan', 'Morelos', 'Nayarit','Nuevo Leon', 'Oaxaca', 'Puebla', 'Queretaro', 'Quintana Roo', 'San Luis Potosi','Sinaloa', 'Sonora', 'Tabasco', 'Tamaulipas', 'Tlaxcala', 'Veracruz', 'Yucatan','Zacatecas')
    cat <- "ESTADO"
    titutlo <- "Estado"
    raw <- mpOrgData$FuenteDeNotificacion
  } else if (categoria == "fuente") {
    categorias <- c("SALUD","IMSS.ORD","ISSSTE","IMSS.OP","DIF","PEMEX","SEDENA","SEMAR","OTRAS")
    cat = "FUENTE"
    titutlo <- "Fuente de notificaci??n"
    raw <- mpOrgData$FuenteDeNotificacion
  } else if (categoria == "grupo") {
    categorias <- c("MAYOR.A.UNO","UNO.A.CUATRO","CINCO.A.NUEVE","DIEZ.A.CATORCE","QUINCE.A.DIECINUEVE","VEINTE.A.VEINTICUATRO","VEINTICINCO.A.CUARENTAYCUATRO","CUARENTAYCINCO.A.CUARENTAYNUEVE","CINCUENTA.A.CINCUENTAYNUEVE","SESENTA.A.SESENTAYCUATRO","MAYOR.A.SESENTAYCINCO","NO.SE.REPORTO.LA.EDAD")
    cat <- "EDAD"
    titutlo <- "Grupo de edad"
    raw <- mpOrgData$GrupoDeEdad
  } else if (categoria == "mes") {
    categorias <- c("ENE","FEB","MAR","ABR","MAY","JUN","JUL","AGO","SEP","OCT","NOV","DIC")
    cat <- "MES"
    titutlo <- "Mes de ocurrencia"
    raw <- mpOrgData$MesDeOcurrencia
  }
  listaDeDataframes <- list()
  for (i in 1:12) {
    porAnio <- subset(raw, ANIO %in% c(2003 + i))
    porAnioYSexo <- subset(porAnio, SEXO %in% c("GENERAL"))
    totales <- c()
    vectorAnios <- c()
    for (j in 1:length(categorias)) {
      porAnioYSexoYCat <- NULL
      if (categoria == "estado") {
        porAnioYSexoYCat <- subset(porAnioYSexo, porAnioYSexo$ESTADO %in% c(categorias[[j]]))
      } else {
        porAnioYSexoYCat <- subset(porAnioYSexo, porAnioYSexo[[4]] %in% c(categorias[[j]]))
      }
      totales <- c(totales, sum(subset(porAnioYSexoYCat$MORDEDURAS, ! is.na(porAnioYSexoYCat$MORDEDURAS))))
      vectorAnios <- c(vectorAnios, 2003 + i)  
    }
    data.frame.anio.categ.total <- data.frame(vectorAnios, categorias, totales)
    names(data.frame.anio.categ.total) <- c("ANIO", cat, "MORDEDURAS")
    listaDeDataframes[[i]] <- data.frame.anio.categ.total
  }
  vectorAnios <- c()
  vectorMaxCat <- c() 
  vectorMaximos <- c()
  vectorMinCat <- c() 
  vectorMinimos <- c()
  vectorMedias <- c()
  vectorVarianzas <- c()
  vectorDesviacionesEstandar <- c()
  vectorPrimerosCuartiles <- c()
  vectorSegundosCuartiles <- c()
  vectorTercerosCuartiles <- c()
  vectorCuartosCuartiles <- c()
  for (k in 1:12) {
    maximo <- max(listaDeDataframes[[k]]$MORDEDURAS)
    minimo <- min(listaDeDataframes[[k]]$MORDEDURAS)
    catMax <- NULL 
    catMin <- NULL 
    if (categoria == "estado") {
      catMax <- paste("",listaDeDataframes[[k]][listaDeDataframes[[k]]$MORDEDURAS == maximo, ]$ESTADO)
      catMin <- paste("",listaDeDataframes[[k]][listaDeDataframes[[k]]$MORDEDURAS == minimo, ]$ESTADO) 
    } else {
      catMax <- paste("",listaDeDataframes[[k]][listaDeDataframes[[k]]$MORDEDURAS == maximo, ][[2]]) 
      catMin <- paste("",listaDeDataframes[[k]][listaDeDataframes[[k]]$MORDEDURAS == minimo, ][[2]]) 
    }
    media <- mean(listaDeDataframes[[k]]$MORDEDURAS)
    varianza <- var(listaDeDataframes[[k]]$MORDEDURAS)
    desviacion.estandar <- sqrt(varianza)
    primerCuartil <- quantile(listaDeDataframes[[k]]$MORDEDURAS)[[1]]
    segundoCuartil <- quantile(listaDeDataframes[[k]]$MORDEDURAS)[[2]]
    tercerCuartil <- quantile(listaDeDataframes[[k]]$MORDEDURAS)[[3]]
    CuartoCuartil <- quantile(listaDeDataframes[[k]]$MORDEDURAS)[[4]]
    vectorAnios <- c(vectorAnios, 2003 + k)
    vectorMaxCat <- c(vectorMaxCat, catMax)
    vectorMaximos <- c(vectorMaximos, maximo)
    vectorMinCat <- c(vectorMinCat, catMin)
    vectorMinimos <- c(vectorMinimos, minimo)
    vectorMedias <- c(vectorMedias, media)
    vectorVarianzas <- c(vectorVarianzas, varianza)
    vectorDesviacionesEstandar <- c(vectorDesviacionesEstandar, desviacion.estandar)
    vectorPrimerosCuartiles <- c(vectorPrimerosCuartiles, primerCuartil)
    vectorSegundosCuartiles <- c(vectorSegundosCuartiles, segundoCuartil)
    vectorTercerosCuartiles <- c(vectorTercerosCuartiles, tercerCuartil)
    vectorCuartosCuartiles <- c(vectorCuartosCuartiles, CuartoCuartil)
  }
  resumen.data.drame <- data.frame(vectorAnios, vectorMaxCat, 
                                   vectorMaximos, vectorMinCat, 
                                   vectorMinimos, vectorMedias,
                                   vectorVarianzas, vectorDesviacionesEstandar,
                                   vectorPrimerosCuartiles, vectorSegundosCuartiles,
                                   vectorTercerosCuartiles, vectorCuartosCuartiles)
  names(resumen.data.drame) <- c("ANIO", paste(cat, ".MAX"), "MAX", paste(cat, ".MIN"), "MIN", "MEDIA", "VAR", "STD", "1st.Q","2nd.Q","3rd.Q","4rd.Q")
  print(resumen.data.drame)
  #info.estado <- tableGrob(resumen.data.drame)
  #return(info.estado)
}
```

#### 6.1.1 Información De Estados
```{r , echo=FALSE}
describe("estado")
```
Para la información de estados pudimos notar que en todos los años el máximo fue el Estado de México, y el mínimo fue entre Colima y Baja California Sur. La media fue oscilando entre 4300 y 3200 con uns desviación estandar muy grande esto se debe a los valores atípicos tan grandes que tenemos. Pero en promedio estaían mordiendo los perros como entre 4000 y 3000 personas.

#### 6.1.2 Información De Fuente de Notificación
```{r , echo=FALSE}
describe("fuente")
```
En Fuente de Notificación pudimos apreciar que la Secretaría de salud siempre ha sido la institución que ha registrado mayor mordeduras de perro en los últimos doce años y que la "SEMAR" es la que menos ha registrado. En estos datos podemos observar una media muy grande al igual que la varianza, probablemente se debe a los valores atípicos que se pudieran registrar. Para eso se harán más análisis para conocer a fondo los datos capturados.

#### 6.1.3 Información De Mes de Ocurrencia
```{r , echo=FALSE}
describe("mes")
```
Para los datos obtenidos en Mes de Ocurrencia podemos apreciar que para el máximo varía con mayor frecuencia el mes siendo: Marzo, Abril, Mayo, Junio, y Julio los meses a través de los años con mayor mordedura de perros. En cambio para el mínimo solo lo comparten Noviembre y Diciembre. También podemos observar como la media va disminuyendo a través de los años, al igual que la desviación estandar, habiendo menor dispersión de los datos con respecto a la media.


#### 6.1.4 Información De Grupo de Edad
```{r , echo=FALSE}
describe("grupo")
```

Como era de esperarse, al ser el intervalo con mayor número de edades, el intervalo de Veinticinco a Cuarenta y Cuatro es el que registra mayor número de mordeduras. Cuando no se reportó la edad, es comprensible que registrara menores casos, porque implica que en la mayoría de los casos se reporta la edad. podemos notar que la media oscila entre 8,500 y 12,000 pero en la mayoría de los casos vemos media entre 9,000 y 10,000 haciendo el supuesto de que en promedio muerden aproximadamente mordieron a más de 9000 personas en cada grupo de edad.t



### 6.2 Tendencia de las Mordeduras
Uno de los primeros planteamientos fue: ¿Cómo la incidencia en mordeduras se había comportado a través de los años? y ¿qué tanto había cambiado?

```{r , echo=FALSE}
# TENDENCIA
fn <- subset(mpOrgData$FuenteDeNotificacion, SEXO  %in% c("GENERAL"))
fn <-subset(fn, !is.na(MORDEDURAS))
years <- c()
sums <- c()
for (i in 1:12) {
  new <- subset(fn, ANIO %in% c(i+2003))
  sums <- c(sums, sum(new$MORDEDURAS))
  years <- c(years, i+2003)
}
FuenteDeN <- data.frame(years, sums)
# Create Line Chart 
xrange <- range(FuenteDeN$years) 
yrange <- range(FuenteDeN$sums) 

ggplot(FuenteDeN, aes(years, sums)) + geom_point(colour = "red", size = 2) + geom_line() + scale_x_continuous(breaks = c(2004:2015)) + labs(x= "", y = "Total de Mordeduras") + ggtitle("TENDENCIA") + scale_y_continuous(breaks = c(sums[7],110000,150000,120000,130000,sums[1], sums[12]))
```

Se creó una gráfica que presentara el total de mordeduras en cada año. Por espacio y limpieza se decidió dejar solo algunos intervalos entre los que destacan el número máximo de mordeduras y el número mínimo de mordeduras.

Con esta gráfica se obseva que la incidencia  demordeduras de perro del año 2004 a 2015 han ido disminuyendo a través del tiempo. Se pude apreciar que a partir de 2010 hubo ligeros incrementos en relación al año anterior, sin embargo estos no llegaron a los niveles de los primeros años. También hubo periodos de tiempo, como 2012 y en 2014, en los que la incidencia de mordeduras de perro disminuyó de manera notoria. Resulta razonable pensar que en general la incidencia en mordeduras siempre se mantuvo por debajo de lo reportado en el año 2004.

### 6.3 Multigráficas a través de los años

#### 6.3.1 El cambio de las Mordeduras en Cada Estado
```{r , echo=FALSE, message=FALSE, warning=FALSE}
#Multiplot de Estados
estados.e <- c('Aguascalientes', 'Baja California', 'Baja California Sur', 'Campeche', 'Chiapas', 'Chihuahua', 'Coahuila', 'Colima', 'Distrito Federal', 'Durango', 'Guanajuato','Guerrero', 'Hidalgo', 'Jalisco', 'Mexico', 'Michoacan', 'Morelos', 'Nayarit','Nuevo Leon', 'Oaxaca', 'Puebla', 'Queretaro', 'Quintana Roo', 'San Luis Potosi','Sinaloa', 'Sonora', 'Tabasco', 'Tamaulipas', 'Tlaxcala', 'Veracruz', 'Yucatan','Zacatecas')
grafs.est <- list()
for (i in 1:12) {
  fn.e <- subset(mpOrgData$FuenteDeNotificacion, ANIO %in% c(2003 + i))
  fn.e1 <- subset(fn.e, SEXO %in% c("GENERAL"))
  valores.e <- c()
  for (j in 1:32) {
    fn.e2 <- subset(fn.e1, ESTADO %in% c(estados.e[[j]]))
    suma.e <- sum(subset(fn.e2$MORDEDURAS, ! is.na(fn.e2$MORDEDURAS)))
    valores.e <- c(valores.e, suma.e)
  }
  estad.data.frame <- data.frame(estados.e, valores.e)
  names(estad.data.frame) <- c("EST", "MORD")
  graf.e <- ggplot(estad.data.frame, aes(x = EST, y = MORD)) +theme_bw() + geom_bar(stat = "identity")+ ggtitle(paste("", 2003 + i)) + theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 3)) + labs(x="", y="Mordeduras") + theme(plot.title = element_text(size = 12)) + theme(axis.text.y = element_text(size=5))  + theme(axis.title.y = element_text(size = 7)) + expand_limits(y=c(0,20000))
  grafs.est[[i]] <- graf.e
}
do.call("grid.arrange", c(grafs.est, ncol=3))
```

En esta parte se muestra cómo va cambiando el total de mordeduras por estado en el transcurso del tiempo, considerando el periodo 2004-2015. Por ejemplo, en la primer gáfica se destacan los estados que tuvieron mayor incidencia en mordeduras de perro en el año 2004. También se apreciar cómo cada año que pasa parace haber un decremento en las mordeduras en todos los estados. Cabe mencionar que pese que las mordeduras mordeduras bajaron conforme transcurre el tiempo, los estados tienden a tener la misma relación en proporciones. Es decir, si quitaramos los valores en el eje de mordeduras, las gráficas de los diferentes años parecen tener una forma muy similar.

#### 6.3.2 El Cambio de las Mordeduras en Cada Fuente de Notificación


```{r , echo=FALSE, message=FALSE, warning=FALSE}
# Fuente de Notificacio en cada a??o.
fuente <- c("SALUD","IMSS.ORD","ISSSTE","IMSS.OP","DIF","PEMEX","SEDENA","SEMAR","OTRAS")
graphs.fn <- list()
for (i in 1:12) {
  fn <- subset(mpOrgData$FuenteDeNotificacion, ANIO %in% c(2003 + i))
  fn <- subset(fn, SEXO %in% c("GENERAL"))
  valores <- c()
  for (j in 1:length(fuente)) {
    fnI <- subset(fn, FUENTE %in% c(fuente[[j]]))
    suma <- sum(fnI$MORDEDURAS)
    valores <- c(valores, suma)
  }
  fn.data.frame <- data.frame(fuente, valores)
  names(fn.data.frame) <- c("Fuente", "Mordeduras")
  graph <- ggplot(fn.data.frame, aes(x = Fuente, y = Mordeduras)) +theme_bw() + geom_bar(stat = "identity")+ ggtitle(paste("", 2003 + i)) + theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 5)) + labs(x="", y="Mordeduras") + theme(plot.title = element_text(size = 12)) + theme(axis.text.y = element_text(size=5))  + theme(axis.title.y = element_text(size = 7)) + expand_limits(y=c(0,100000))
  graphs.fn[[i]] <- graph
}
do.call("grid.arrange", c(graphs.fn, ncol=3))
```

Notamos el cambio a través de los años de la incidencia de mordeduras en cada una de la instituciones de salud mencionadas. Notamos que el cambio en cuanto a las notificaciones de mordeduras de perro no cambian en gran medida. Identificamos que  "SALUD" es la que reporta más casos de mordeduras en todos los años. "SALUD" la consideramos un valor atípico, es decir el número de casos que reporta se encuentra muy por encima del promedio, considerando las otras instituciones.
Otra observación importante es que "IMSS.OP" disminuyó considerablemente el registro de mordeduras mientras que "ISSTE" registra cada vez más. 
Cabe mencionar que en muchas instituciones no se registraron datos, es por eso que en la mayoría de las gráficas hay muchas instituciones que no se logran apreciar con gran claridad, esto tiene también que ver con los procesos de captura de datos y reporte que se maneja en este tipo de instituciones.


#### 6.3.3 El Cambio de las Mordeduras en Mes de Ocurrencia

```{r , echo=FALSE, message=FALSE, warning=FALSE}
# Mes de ocurrencia en cada a??o.
mes1 <- c("ENE","FEB","MAR","ABR","MAY","JUN","JUL","AGO","SEP","OCT","NOV","DIC")
mes <- c("ENE","FEB","MAR","ABR","MAY","JUN","JUL","AGO","SEP","OCT","NOV","DIC")
mes <- as.factor(mes)
levels(mes) <- c("ENE","FEB","MAR","ABR","MAY","JUN","JUL","AGO","SEP","OCT","NOV","DIC")
graphs.mo <- list()
for (i in 1:12) {
  mo <- subset(mpOrgData$MesDeOcurrencia, ANIO %in% c(2003 + i))
  mo <- subset(mo, SEXO %in% c("GENERAL"))
  valores <- c()
  for (j in 1:length(mes)) {
    moI <- subset(mo, MES %in% c(mes1[[j]]))
    suma <- sum(subset(moI$MORDEDURAS, ! is.na(moI$MORDEDURAS)))
    valores <- c(valores, suma)
  }
  mo.data.frame <- data.frame(mes, valores)
  names(mo.data.frame) <- c("Mes", "Mordeduras")
  graph <- ggplot(mo.data.frame, aes(x = Mes, y = Mordeduras)) +theme_bw() + geom_bar(stat = "identity")+ ggtitle(paste("", 2003 + i)) + theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 5)) + labs(x="", y="Mordeduras") + theme(plot.title = element_text(size = 12)) + theme(axis.text.y = element_text(size=7))  + theme(axis.title.y = element_text(size = 7)) + expand_limits(y=c(0,15000))
  
  graphs.mo[[i]] <- graph
}
do.call("grid.arrange", c(graphs.mo, ncol=3))
```

Esta gráfica permite hacer una comparación con la gráfica de tendencia y ver que en efecto, a través de los años va bajando la incidencia en mordeduras de perro. En general las gráficas no parecen variar mucho un mes con respecto al otro, y esta característica se mantiene a lo largo de los doce año que se analizaron. Dicho resultado no es difícil de digerir, si consideramos que los perros muerden por igual en todos los meses del año, uno pudiese esperar ciertos cambios en determinados meses del año por los ciclos de reproducción, sin embargo no hay evidencia de que esto afecte considerablemente.

#### 6.3.4 El Cambio de las Mordeduras en Grupo de Edad

```{r , echo=FALSE, message=FALSE, warning=FALSE}
# Grupo de edad en cada a??o.
grupoedad <- c("Ma1","1a4","5a9","10a14","15a19","20a24","25a44","45a49","50a59","60a64","Ma65","NSRE")
grupoedad <- as.factor(grupoedad)
levels(grupoedad) <- c("Ma1","1a4","5a9","10a14","15a19","20a24","25a44","45a49","50a59","60a64","Ma65","NSRE")
intervalos <- c("MAYOR.A.UNO","UNO.A.CUATRO","CINCO.A.NUEVE","DIEZ.A.CATORCE","QUINCE.A.DIECINUEVE","VEINTE.A.VEINTICUATRO","VEINTICINCO.A.CUARENTAYCUATRO","CUARENTAYCINCO.A.CUARENTAYNUEVE","CINCUENTA.A.CINCUENTAYNUEVE","SESENTA.A.SESENTAYCUATRO","MAYOR.A.SESENTAYCINCO","NO.SE.REPORTO.LA.EDAD")
graphs.ge <- list()
for (i in 1:12) {
  ge <- subset(mpOrgData$GrupoDeEdad, ANIO %in% c(2003 + i))
  ge <- subset(ge, SEXO %in% c("GENERAL"))
  valores <- c()
  for (j in 1:length(intervalos)) {
    geI <- subset(ge, EDAD %in% c(intervalos[[j]]))
    suma <- sum(geI$MORDEDURAS)
    valores <- c(valores, suma)
  }
  ge.data.frame <- data.frame(grupoedad, valores)
  names(ge.data.frame) <- c("Grupo", "Mordeduras")
  graph <-  ggplot(ge.data.frame, aes(x = Grupo, y = Mordeduras)) +theme_bw() + geom_bar(stat = "identity")+ ggtitle(paste("", 2003 + i)) + theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 6)) + labs(x="", y="Mordeduras") + theme(plot.title = element_text(size = 12)) + theme(axis.text.y = element_text(size=7))  + theme(axis.title.y = element_text(size = 6)) + expand_limits(y=c(0,30000))

  graphs.ge[[i]] <- graph
}
do.call("grid.arrange", c(graphs.ge, ncol=3))
```

Existe una constante en los resultados obtenidos hasta este momento, esta es, como ya se ha mencionada, la existencia de una tendencia a la baja en la incidencia de mordeduras de perro. Dicho resultado lo vemos nuevamente en cada grupo de edad. De antemano notamos que el grupo de edad que más mordeduras tuvo fue el de "25-44". Este resultado se debe en parte a que es el grupo con un mayor rango de edad; dado que abarca veinte años y gran parte de la población de México se encuentra en este rango de edad, puede haber más personas dentro de dicho intervalo. Uno de los puntos que consideramos importantes en este análisis es la cantidad de perros que muerden a niños muy chicos, ya que se encuentra en el tercer lugar en cuanto a mordeduras. Creemos que se podrían tomar medidas para fomentar la prevención en los padres con respecto a las precauciones que se deben tener con todo tipo de animales, a pesar de que estos sean considerados domésticos.

### 6.4 Boxplots
Para cada Boxplot el promedio está representada por un rombo rojo.
Un boxplot o diagrama de caja proporciona una visión general de la simetría de la distribución de los datos. Este dipo de diagrama es útil para ver la presencia de valores atípicos, la dispersión de los puntos con la mediana, los percentiles 25 y 75, y los valores máximos y mínimos. Note que el 50% de la población está en los límites de la "caja".

```{r , echo=FALSE, message=FALSE, warning=FALSE}
# BOXPLOTs 
boxplotea <- function (categoria, sexo) {
  cat <- NULL
  raw <- NULL
  categorias <- c()
  titulo <- NULL
  if (categoria == "fuente") {
    categorias <- c("SALUD","IMSS.ORD","ISSSTE","IMSS.OP","DIF","PEMEX","SEDENA","SEMAR","OTRAS")
    cat = "FUENTE"
    raw <- mpOrgData$FuenteDeNotificacion
  } else if (categoria == "grupo") {
    categorias <- c("MAYOR.A.UNO","UNO.A.CUATRO","CINCO.A.NUEVE","DIEZ.A.CATORCE","QUINCE.A.DIECINUEVE","VEINTE.A.VEINTICUATRO","VEINTICINCO.A.CUARENTAYCUATRO","CUARENTAYCINCO.A.CUARENTAYNUEVE","CINCUENTA.A.CINCUENTAYNUEVE","SESENTA.A.SESENTAYCUATRO","MAYOR.A.SESENTAYCINCO","NO.SE.REPORTO.LA.EDAD")
    cat <- "EDAD"
    raw <- mpOrgData$GrupoDeEdad
  } else if (categoria == "mes") {
    categorias <- c("ENE","FEB","MAR","ABR","MAY","JUN","JUL","AGO","SEP","OCT","NOV","DIC")
    cat <- "MES"
    raw <- mpOrgData$MesDeOcurrencia
  } else if (categoria == "estado") {
    categorias <- c('Aguascalientes', 'Baja California', 'Baja California Sur', 'Campeche', 'Chiapas', 'Chihuahua', 'Coahuila', 'Colima', 'Distrito Federal', 'Durango', 'Guanajuato','Guerrero', 'Hidalgo', 'Jalisco', 'Mexico', 'Michoacan', 'Morelos', 'Nayarit','Nuevo Leon', 'Oaxaca', 'Puebla', 'Queretaro', 'Quintana Roo', 'San Luis Potosi','Sinaloa', 'Sonora', 'Tabasco', 'Tamaulipas', 'Tlaxcala', 'Veracruz', 'Yucatan','Zacatecas')
    cat <- "ESTADO"
    raw <- mpOrgData$FuenteDeNotificacion
  }
  sexos <- NULL
  if (sexo == "general") {
    sexos <- "GENERAL" 
  } else if (sexo == "hombres") {
    sexos <- "HOMBRES"
  } else if (sexo == "mujeres") {
    sexos <- "MUJERES"
  }
  listaDeDataframes <- list()
  for (i in 1:12) {
    porAnio <- subset(raw, ANIO %in% c(2003 + i))
    porAnioYSexo <- subset(porAnio, SEXO %in% c(sexos))
    totales <- c()
    vectorAnios <- c()
    for (j in 1:length(categorias)) {
      porAnioYSexoYCat <- NULL
      if (categoria == "estado") {
        porAnioYSexoYCat <- subset(porAnioYSexo, porAnioYSexo$ESTADO %in% c(categorias[[j]]))
      } else {
        porAnioYSexoYCat <- subset(porAnioYSexo, porAnioYSexo[[4]] %in% c(categorias[[j]]))
      }
      totales <- c(totales, sum(subset(porAnioYSexoYCat$MORDEDURAS, ! is.na(porAnioYSexoYCat$MORDEDURAS))))
      vectorAnios <- c(vectorAnios, 2003 + i)
    }
    dataTemporal <- data.frame(categorias, vectorAnios, totales)
    listaDeDataframes[[i]] <- dataTemporal
  }
  dataConcat <- do.call(rbind, listaDeDataframes)
  names(dataConcat) <- c(cat, "ANIO", "TOTAL.MORDEDURAS")
  means <- aggregate(TOTAL.MORDEDURAS ~  ANIO, dataConcat, mean)
  p <- ggplot(dataConcat, aes(x=factor(ANIO), y=TOTAL.MORDEDURAS)) 
  p + geom_boxplot() + ggtitle(paste(paste(titulo, " :"), sexos)) + labs(x="",y="Total de Mordeduras") + theme(plot.title = element_text(family = "Trebuchet MS", color="#666666", face="bold", size=11, hjust=0))  + stat_summary(fun.y=mean, colour="darkred", geom="point", shape=18, size=3,show_guide = FALSE)
}
```


#### 6.4.1 Boxplot del Total de Mordeduras a Través de los Años de Cada Estado

```{r , echo=FALSE, message=FALSE, warning=FALSE}
boxplotea("estado", "general") + ggtitle("")
```

En este boxplot se representa el total de mordeduras que hubo a través de los años para cada estado.  Por medio de esto se permite deducir que en todos los años el promedio de mordeduras estaba por arriba del valor en el cual se acumulaba el 50% de la distribución (i.e mediana). Esto es evidencia de que la distribución de la incidencia en mordeduras se encuentra sesgada a la derecha en todos los años, es decir la distribución está muy cargada a la derecha (e.g si pensamos en una distribución normal ésta sería más "gorda" del lado derecho). 
Con respecto a los valores fuera de los límites del diagrama, destaca el "Distrito Federal" y el Estado de México, en este caso "México". Ambos registran el mayor número de mordedruras de todos los estados. La media generalmente se encuentra alrededor de 5000 y 2500, aproximadamente muerden esta cantidad de perros a personas en los estados. Podríamos formular hipótesis al respecto, probablemente exista una relación directa entre el número de personas que habitan una región y el número de perros, recordemos que estos son animáles domésticos. 


##### 6.4.1.2 Boxplot del Total de Mordeduras a Través de los Años de Cada Estado para Hombres y Mujeres

```{r , echo=FALSE, message=FALSE, warning=FALSE}
r1 <- boxplotea("estado", "hombres") + ggtitle("Hombres") + theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 8)) + expand_limits(y=c(0,12500))

r2 <- boxplotea("estado", "mujeres") + ggtitle("Mujeres") + theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 8)) + expand_limits(y=c(0,12500))

grid.arrange(r1, r2, ncol = 2, nrow = 1)
```

Este diagrama hace la separación de hombres y mujeres.Nuevamente podemos apreciar que el promedio tiende a estar hacia la parte de arriba de la "caja". Un punto a resaltar, es que en cuanto a Hombres y Mujeres se puede llegar a la conclusión que en general muerden más a hombres que a mujeres en todos los Estados.Comparando los datos de hombres con los datos de mujeres, los promedios se encuentran por el mismo intervalo y no es demaisada la dispersión de estos.

#### 6.4.2 Boxplot del Total de Mordeduras a Través de los Años de Fuente de Notificación
```{r , echo=FALSE, message=FALSE, warning=FALSE}
boxplotea("fuente", "general") + ggtitle("")
```

En este caso vemos que el promedio de Fuente de Notificación se localiza fuera de la "caja". Esto ocurre porque en Fuente de Notificación existen varios "Sin registros" por parte de las instituciones y como la institución "SALUD" contiene la mayoría de los casos desplaza al promedio por arriba de la mitad de la "caja", convirtiéndose "SALUD" en un valor extremadamente raro.


##### 6.4.2.1 Boxplot del Total de Mordeduras a Través de los Años de Fuente de Notificación para Hombres y Mujeres

```{r , echo=FALSE, message=FALSE, warning=FALSE}
r1.f <- boxplotea("fuente", "hombres") + ggtitle("Hombres") + theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 8)) + expand_limits(y=c(0,65000))

r2.f <- boxplotea("fuente", "mujeres") + ggtitle("Mujeres") + theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 8)) + expand_limits(y=c(0,65000))

grid.arrange(r1.f, r2.f, ncol = 2, nrow = 1)
```

Consideramos los boxplots de hombres y mujeres para fuente de notificación para entender cómo se estaban registrando las mordeduras para ambos géneros. Pudimos notar que las instituciones registran más hombres que mujeres con mordeduras de perro. Aun así, al igual que por Estados, el promedio y el valor que acumula el 50% de la distribución no tienen un gran cambio en hombre mujer.

#### 6.4.3 Boxplot del Total de Mordeduras a Través de los Años de Fuente de Mes de Ocurrencia
```{r , echo=FALSE, message=FALSE, warning=FALSE}
boxplotea("mes", "general") + ggtitle("")
```
En Mes de Ocurrencia se presentan datos más dispersados que en los pasados diagramas. Hay sesgos a las derecha como a la izquierda. Esto es que los promedios a través de los años varían en dónde se localizan, hay tanto por arriba de la mitad de la "caja", como por debajo de ella. Incluso notamos que en varios años, por ejemplo 2015, que el promedio se acerca a la mitad del diagrama (i.e simetría). En algunos años no existen valores fuera de los límites del diagrama. 
Si se compara con la gráfica de Tendencia se concluye que es razonable que la media vaya bajando a través de los años ya que previamente se encontró evidencia que la cantidad mordeduras disminuyó con en el transcurso del tiempo.

##### 6.4.3.1 Boxplot del Total de Mordeduras a Través de los Años de Mes de Ocurrencia para Hombres y Mujeres

```{r , echo=FALSE, message=FALSE, warning=FALSE}
r1.m <- boxplotea("mes", "hombres") + ggtitle("Hombres") + theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 8)) + expand_limits(y=c(0,10000))

r2.m <- boxplotea("mes", "mujeres") + ggtitle("Mujeres") + theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 8)) + expand_limits(y=c(0,10000))

grid.arrange(r1.m, r2.m, ncol = 2, nrow = 1)
```

Al observar el boxplot de hombres y mujeres se encuentra evidencia de que los perros muerden más a los hombres que a las mujeres. En este caso notamos una mayor inclinación del promedio a los extremos, ya sea inferiores o superiores, de la caja. Esto implica que muerden en mayor medida a los hombres cada año, ya que si se esta haciendo por mes el promedio va ligado estrictamente al año mencionado.

#### 6.4.4 Boxplot del Total de Mordeduras a Través de los Años de Grupo de Edad 
```{r , echo=FALSE, message=FALSE, warning=FALSE}
boxplotea("grupo", "general") + ggtitle("")
```

En el boxplot de Grupo de Edad apreciamos un sesgo a la derecha en todos los años, pero se puede ver también que el sesgo ha estado disminuyendo através de los años, esto hace la media más cercana a la mediana.
Con lo anterior se puede argumentar que ha habido mayor similitud en las mordeduras de grupos de edad a través de los años. Uno de los problemas que siempre registrará el gurpo de edad es que existe un intervalo demasiado grande que abarca a más persona que en otro.

##### 6.4.4.1 Boxplot del Total de Mordeduras a Través de los Años de Grupo de Edad para Hombres y Mujeres

```{r , echo=FALSE, message=FALSE, warning=FALSE}
r1.g <- boxplotea("grupo", "hombres") + ggtitle("Hombres") + theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 8)) + expand_limits(y=c(0,18000))

r2.g <- boxplotea("grupo", "mujeres") + ggtitle("Mujeres") + theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 8)) + expand_limits(y=c(0,18000))

grid.arrange(r1.g, r2.g, ncol = 2, nrow = 1)
```

En el boxplot de Hombres notamos un sesgo a la derecha mucho mayor que en el de las mujeres. En el de las mujeres apreciamos un mayor acercamiento a la simetría que en el caso de los hombres.

## 7. Conclusiones

Después de observar, analizar y graficar los datos obtenidos, se pudo concluir:
Primero, los datos de cualquiera de las fuentes (Fuente de Notificación, Mes de Ocurrencia o Grupo de Edad) presentan una gran similitud a través de los años, podrán variar y disminuir las mordeduras perro en cada una de las variables originales, siempre oscilan en el mismo intervalo. Esto nos obliga a dudar de la veracidad de los datos, nos hace preguntarnos si en verdad se están capturando los datos de manera eficiente y real. En caso de que estemos equivocados tenemos que concluir que las Mordeduras de Perro presentan un patrón muy común. Se pueden utilizar métodos numéricos para crear aproximaciones a los patrones y hacer buenas estimaciones de los próximos años. 

Otra de nuestras conclusiones nace de la captura de los datos. En fuente de Notificación, prácticamente solo hay una institución que está registrando las mordeduras de perro, también creemos que "OTRAS" puede llegar a resultar muy ambiguo y con motivos a dudar si en "OTRAS" se incluyen a todas las instituciones públicas como tanto privadas.
En Grupo de Edad, se deben cambiar los intervalos de edad porque al momento de hacer cualquier análisis estadístico se alteraran las conclusiones si se tiene un intervalo de 19 años. 

Creemos que México debe ser educado en cuanto a la captura de información, México no se está actualizando en las capturas de información y esto está provocando análisis dudosos y poco nutritivos. Si los análisis se están haciendo con datos falsos o con datos faltantes se están haciendo análisis falsos y análisis incompletos. 
Cada país toma decisiones con base a análisis estadísticos, porque estos se encargan de presentar pronósticos y aproximaciones de la realidad, y con esto dichas decisiones más acertadas a lo demandado por la realidad.
Si México está capturando erróneamente sus datos está produciendo datos falsos y esto implicaría malas decisiones, y un mal empleo de los recursos.

Creemos que es tiempo de revisar y cuestionar los métodos utilizados para capturar información, ya que los estadísticos tiene como obligación presentar datos verídicos como los menciona Stephen Few y como lo establece "The Actuarial Standard of Practice"
Se debe ser crítico con los datos y mucho más con nuestro trabajo como lo menciona Edward Tufte, por eso en este trabajo se trata de ser muy crítico y reflejar la realidad de los datos capturados.






